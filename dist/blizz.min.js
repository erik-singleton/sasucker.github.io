/*! sasucker.github.io 20150306 */
(function(a,b){b["true"]=a;"use strict";angular.module("blizzso",["ngAnimate","ui.router","blizzso.loader","blizzso.login","blizzso.question","blizzso.search","blizzso.user","blizzso.utils","hljsWrapper","SEWrapper"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/");a.state("user",{url:"/",views:{bodycontent:{templateUrl:"template/user/main.partial.html",controller:"UserCtrl",controllerAs:"user"}}}).state("user.logout",{url:"logout",views:{"bodycontent@":{template:"<div></div>"}},onEnter:["$state","$window","userConfig",function(a,b,c){b.localStorage.removeItem("accessToken");b.localStorage.removeItem("expirationToken");c.accessToken=null;a.go("user.login")}]}).state("user.login",{url:"login",views:{"bodycontent@":{templateUrl:"template/login/main.partial.html"}},onEnter:["$state","userConfig",function(a,b){if(b.loggedIn()){a.go("^")}}]}).state("search",{url:"/search",views:{bodycontent:{templateUrl:"template/search/main.partial.html",controller:"SearchCtrl",controllerAs:"search"}}}).state("search.terms",{url:"/?q&sort&intitle&tagged&nottagged&page",resolve:{searchModel:["$stateParams","searchModel",function(a,b){var c=a;return b.search({intitle:c.intitle,nottagged:c.nottagged,page:c.page,sort:c.sort,tagged:c.tagged}).$promise}]},views:{searchview:{templateUrl:"template/search/searchterms.partial.html",controller:"SearchCtrl",controllerAs:"search"}}}).state("question",{url:"/question/:id",resolve:{question:["$stateParams","questionModel",function(a,b){var c=a.id;return b.get({id:c}).$promise}]},views:{bodycontent:{templateUrl:"template/question/main.partial.html",controller:"QuestionCtrl",controllerAs:"qc"}}})}]).run(["$rootScope","$timeout","$location","$window","SE","SEConfig","userConfig",function(a,b,c,d,e,f,g){e.init({clientId:f.clientId,key:f.key,channelUrl:f.channelUrl,complete:function(a){}});if(typeof d.localStorage==="object"){g.accessToken=d.localStorage.getItem("accessToken")}a.$on("$stateChangeStart",function(a,d,e){if(!g.loggedIn()){if(d.name!=="login"){b(function(){c.path("/login")})}}})}]);angular.module("hljsWrapper",[]).factory("hljs",["$window",function(a){return a.hljs}]).directive("hljsSnippet",["$timeout","$interpolate","hljs",function(a,b,c){function d(b,d,e){a(function(){c.initHighlighting()})}return{restrict:"A",template:"<div ng-transclude></div>",replace:true,transclude:true,link:d}}]);angular.module("blizzso.loader.directives",[]).directive("loader",["$rootScope",function(a){return function(a,b,c){a.$on("loader_show",function(){return b.removeClass("ng-hide")});return a.$on("loader_hide",function(){return b.addClass("ng-hide")});a.$on("event:auth-loginRequired",function(){console.log("auth req")})}}]);angular.module("blizzso.loader",["blizzso.loader.directives","blizzso.loader.services"]).config(["$httpProvider",function(a){a.interceptors.push("blizzAjaxInterceptor")}]);angular.module("blizzso.loader.services",[]).factory("blizzAjaxInterceptor",["$q","$rootScope",function(a,b){var c=0;return{request:function(d){c++;b.$broadcast("loader_show");return d||a.when(d)},response:function(d){if(--c===0){b.$broadcast("loader_hide")}return d||a.when(d)},responseError:function(d){if(!--c){b.$broadcast("loader_hide")}return a.reject(d)}}}]);angular.module("blizzso.login.directives",["ui.router","blizzso.user","SEWrapper"]).directive("blizzsoLogin",["$state","$window","SEConfig","SE","userConfig",function(a,b,c,d,e){function f(c,f,g){c.login=function(){d.authenticate({success:function(c){b.localStorage.setItem("accessToken",c.accessToken);b.localStorage.setItem("expirationDate",c.expirationDate);e.accessToken=c.accessToken;a.go("user")},error:function(a){console.log(a)},scope:["read_inbox","write_access","private_info"]})}}return{scope:{},restrict:"EA",templateUrl:"template/login/blizzsologin.partial.html",replace:true,link:f}}]);angular.module("blizzso.login",["blizzso.login.directives"]);angular.module("blizzso.question.controllers",[]).controller("QuestionCtrl",c);function c(a,b,c,d){var e=this;e.$http=a;e.userConfig=b;e.SEConfig=c;e.question=d;e.commentLimit=5;e.answerLimit=10}c.$inject=["$http","userConfig","SEConfig","question"];c.prototype.favorite=function(){var a=this;var b=a.question.favorited?"undo":"";var c={method:"POST",url:"https://api.stackexchange.com/2.2/questions/"+a.question.question_id+"/favorite/"+b,data:{access_token:a.userConfig.accessToken,key:a.SEConfig.key,site:a.userConfig.site,filter:a.SEConfig.filter},headers:{"Content-Type":"application/x-www-form-urlencoded"},transformResponse:function(a){return JSON.parse(a).items[0]},transformRequest:function(a){var b=[];for(var c in a){if(a.hasOwnProperty(c)){b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]))}}return b.join("&")}};a.$http(c).then(function(b){a.question=angular.copy(b.data)},function(a){console.log(a)})};angular.module("blizzso.question.directives",["blizzso.nicenum"]).directive("blizzsoQuestion",function(){return{restrict:"EA",replace:true,scope:{question:"="},templateUrl:"template/question/blizzsoquestion.partial.html"}}).directive("blizzsoAnswer",function(){return{restrict:"EA",replace:true,scope:{answer:"="},templateUrl:"template/question/blizzsoanswer.partial.html"}}).directive("blizzsoComment",function(){return{restrict:"EA",replace:true,scope:{comment:"=",commentLimit:"="},templateUrl:"template/question/blizzsocomment.partial.html"}});angular.module("blizzso.question",["blizzso.question.controllers","blizzso.question.directives","blizzso.question.services"]);angular.module("blizzso.question.services",["ngResource","blizzso.user","SEWrapper"]).factory("questionModel",["$resource","userConfig","SEConfig",function(a,b,c){return a("https://api.stackexchange.com/2.2/questions/:id",{access_token:b.accessToken,key:c.key,filter:c.filter,site:b.site},{get:{method:"GET",cache:true,transformResponse:function(a){return JSON.parse(a).items[0]}}})}]);angular.module("SEWrapper",[]).constant("SEConfig",{clientId:4378,key:"Re3GNAs1lf8dHOTZn3S5Gw((",channelUrl:"http://sasucker.github.io/blank/",filter:"!Wq.reBhTC*mybEAh961k3.)jNlZdP5g-wIcnBX6"}).factory("SE",["$window",function(a){return a.SE}]);angular.module("blizzso.search.controllers",[]).controller("SearchCtrl",d);function d(a,b,c){var d=this;d.terms={nottags:"",sort:"relevance",tags:""};d.$stateParams=a;d.$state=b;d.results=c;d.currentPage=c.page}d.$inject=["$stateParams","$state","searchModel"];d.prototype.submit=function(){var a=this;var b=a.terms.tags.split(" ").join(";");var c=a.terms.nottags.split(" ").join(";");a.$state.go("search.terms",{tagged:b,nottagged:c,intitle:a.terms.title,page:null,sort:a.terms.sort})};angular.module("blizzso.search.directives",[]).directive("blizzsoResultCloud",["$timeout",function(a){function b(a,b,c){a.baseSize=11;a.maxSize=24;a.maxNum=a.results.maxTagCount;a.tags=a.results.tags}return{restrict:"EA",transclude:true,replace:true,scope:{results:"="},templateUrl:"template/search/blizzsoresultcloud.partial.html",link:b}}]);angular.module("blizzso.search",["blizzso.search.controllers","blizzso.search.directives","blizzso.search.services"]);angular.module("blizzso.search.services",["ngResource","SEWrapper","blizzso.user"]).factory("searchModel",["$resource","userConfig","SEConfig",function(a,b,c){return a("https://api.stackexchange.com/2.2/search",{tagged:"@tagged",nottagged:"@nottagged",intitle:"@intitle",sort:"@sort",page:"@page",key:c.key,filter:"!9YdnSQVgz",site:b.site},{search:{method:"GET",cache:true,transformResponse:function(a){var a=JSON.parse(a);var b=a.items;var c={};var d=0;var e,f,g,h;for(e=0,g=b.length;e<g;e++){var i=b[e].tags;for(f=0,h=i.length;f<h;f++){if(!c.hasOwnProperty(i[f])){c[i[f]]=1}else{c[i[f]]++}d=c[i[f]]>d?c[i[f]]:d}}a.tags=c;a.maxTagCount=d;return a}}})}]);angular.module("blizzso.user.controllers",[]).controller("UserCtrl",e);function e(a){var b=this;b.badges=a.badges();b.favorites=a.favorites();b.info=a.info();b.tags=a.tags();b.timeline=a.timeline();b.badgeConverter={accepted:{slug:"accepted-wrapper",verb:"accepted"},answered:{slug:"answered-wrapper",verb:"answered"},asked:{slug:"asked-wrapper",verb:"asked"},badge:{slug:"individual-badge",verb:"earned"},revision:{slug:"revision-wrapper",verb:"revised"},reviewed:{slug:"reviewed-wrapper",verb:"reviewed"},suggested:{slug:"suggested-wrapper",verb:"suggested"}}}e.$inject=["userProfile"];e.prototype.isBadge=function(a){return a.timeline_type==="badge"};angular.module("blizzso.user.services",["ngResource","SEWrapper"]).factory("userConfig",function(){return{accessToken:null,expirationDate:null,site:"stackoverflow",loggedIn:function(){return!!this.accessToken}}}).factory("userProfile",["$resource","userConfig","SEConfig",function(a,b,c){return a("https://api.stackexchange.com/2.2/me/:verb",{access_token:b.accessToken,site:b.site,key:c.key,filter:c.filter},{info:{method:"GET",cache:true,transformResponse:function(a){var b=JSON.parse(a);if(b.items){return b.items[0]}else{return b}}},badges:{method:"GET",cache:true,params:{verb:"badges",pagesize:50}},timeline:{method:"GET",cache:true,params:{verb:"timeline",pagesize:5}},tags:{method:"GET",cache:true,params:{verb:"tags",sort:"name",order:"asc",pagesize:50}},favorites:{method:"GET",cache:true,params:{verb:"favorites",sort:"activity",order:"desc"}}})}]);angular.module("blizzso.user",["blizzso.user.services","blizzso.user.controllers"]);angular.module("blizzso.exploremenu",[]).directive("blizzsoExplore",["$timeout",function(a){function b(b,c,d){b.showMenu=false;b.toggleMenu=function(){a(function(){c.toggleClass("active");angular.element(c.children()[1]).toggleClass("ng-hide")})}}return{scope:{},restrict:"EA",templateUrl:"template/core/blizzsoexplore.partial.html",replace:true,link:b}}]);angular.module("blizzso.milliseconds",[]).filter("milli",function(){return function(a){return parseInt(a)*1e3}});angular.module("blizzso.nicenum",[]).filter("nicenum",function(){return function(a){var b=["k","m","b"];var c=a;for(var d=b.length-1;d>=0;d--){var e=Math.pow(10,(d+1)*3);if(c>=e){c=Math.round(c/e);if(c===1e3&&d<b.length-1){c=1;d++}c+=b[d];break}}return c}});angular.module("blizzso.unsafe",[]).filter("unsafe",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]);angular.module("blizzso.utils",["blizzso.exploremenu","blizzso.milliseconds","blizzso.nicenum","blizzso.tagcloud","blizzso.unsafe"]);angular.module("blizzso.tagcloud",[]).directive("blizzsoTagCloud",function(){function a(a,b,c){a.baseSize=11;a.maxSize=24;a.tags.$promise.then(function(b){a.tags.items=b.items;a.maxNum=0;for(var c=0,d=a.tags.items.length;c<d;c++){if(a.maxNum<a.tags.items[c].count){a.maxNum=a.tags.items[c].count}}})}return{restrict:"EA",transclude:true,replace:true,scope:{tags:"="},templateUrl:"template/tag/blizzsotagcloud.partial.html",link:a}})})({},function(){return this}());